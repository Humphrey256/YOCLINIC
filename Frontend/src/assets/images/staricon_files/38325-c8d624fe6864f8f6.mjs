"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["38325"],{99699:function(e,t,n){n.d(t,{Z:()=>J});var i=n("667294"),r=n("581722"),o=n("219300"),s=n("694623"),l=n("555597");let u=[9,3];var _=n("533363"),a=n("30526"),c=n("24461"),d=n("744207"),E=n("221622"),h=n("387094"),m=n("320288");function v(e,t,n){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:String(i))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let p=e=>{let t=!1;return(...n)=>{t||(t=!0,e(...n))}},f=null,g=(0,_.ZP)();class T{constructor(e){v(this,"_logTimeoutLong",null),v(this,"_logTimeoutShort",null),v(this,"_clickthroughStartEvent",null),v(this,"_utcDate",new Date),v(this,"_shortFlushTimoutExperimentEnabled",!1),v(this,"_isVisiblityExperimentEnabled",!1),v(this,"_collectionClickthroughEndEvent",null),this._shortFlushTimoutExperimentEnabled=e.shortFlushTimoutExperimentEnabled,this._isVisiblityExperimentEnabled=e.isVisiblityExperimentEnabled;let t=e=>{let{activeElement:t}=document;if(t&&t.id===l.ZP.VIDEO_IFRAME_ID&&t){setTimeout(()=>t.blur(),0);return}c.Z.pause(d.LU),this.flushEvents(e)},n=p(()=>t(!0)),i=()=>{c.Z.resume(d.LU)};{window.addEventListener("beforeunload",n),window.addEventListener("pagehide",n),window.addEventListener("focus",i),window.addEventListener("blur",()=>t(!1));let{hidden:e,visibilityChange:r}=(0,a.s)();r&&this._isVisiblityExperimentEnabled&&window.addEventListener(r,()=>{document[e]?t(!1):(this.flushEvents(),i())},!1)}}setTimeoutToFlushEvents(e){let t=e.event_type;if(u.includes(e.view_type)&&!this._logTimeoutShort&&13===t)this._logTimeoutShort=setTimeout(this.flushEvents.bind(this,!1,!0),300);else if(!this._logTimeoutLong){let e=this._shortFlushTimoutExperimentEnabled?300:1e4;this._logTimeoutLong=setTimeout(this.flushEvents.bind(this),e)}}addEvent(e,t){let n=e.event_type;if(null==n||!(0,_.cA)(e))return;this.setTimeoutToFlushEvents(e);let i=(0,_.li)(e,t);i.appState=E.Z.getAppState();let r=_.Ch[n];if(r){if(r.startsWith("storyImpression")){i.event_data?.storyImpressions&&(i.event_data.storyImpression=i.event_data.storyImpressions,delete i.event_data.storyImpressions),g.logImpression((0,_.a)(i,"storyImpression"));return}(0,_.nc)(i,r).forEach(g.logImpression);return}if((0,m.nP)("webapp.contextLogger.impressionType",{sampleRate:.01,tags:{event_type:n}}),g.logContextEvent(i),12===n&&(g.logContextEvent({...i,event_type:7946}),this._clickthroughStartEvent={...i,time:1e6*Date.now()},f?.storeClickthroughProperties({view_type:i.view_type,view_parameter:i.view_parameter,component:i.component,element:i.element,object_id_str:i.object_id_str,view_data:i.view_data,aux_data:i.aux_data,clientTrackingParams:i.clientTrackingParams})),7761===n||7762===n){let e=7761===n?7777:7843;this._collectionClickthroughEndEvent={...i,event_type:e}}if(4100===n&&this._collectionClickthroughEndEvent){let e=this._collectionClickthroughEndEvent;this._collectionClickthroughEndEvent=null;let t={...e,object_id_str:i.object_id_str,duration_ns:i.duration_ns};g.logContextEvent(t)}}flushEvents(e){let t=g.getContextEvents?.();t&&t.length&&g.flushContextEvents(e),this._reset()}_reset(){this._resetShortTimerEvents(),this._resetLongTimerEvents()}_resetShortTimerEvents(){g.resetEventsBuffer?.(),clearTimeout(this._logTimeoutShort),this._logTimeoutShort=null}_resetLongTimerEvents(){g.resetEventsBuffer?.(),clearTimeout(this._logTimeoutLong),this._logTimeoutLong=null}}var w=n("14890"),y=n("798953"),x=n("674817"),P=n("785893");function A({children:e}){let[t,n]=(0,i.useReducer)((e,t)=>{if("MOUNT_PLACEMENT"===t.type)return{...e,mountedPlacements:{...e.mountedPlacements,[t.payload]:!0}};if("UNMOUNT_PLACEMENT"===t.type){let n={...e};return delete n.mountedPlacements[t.payload],delete n.registerdAfterActionPlacements[t.payload],n}return"REGISTER_AFTER_ACTION_PLACEMENT"===t.type?{...e,registerdAfterActionPlacements:{...e.registerdAfterActionPlacements,[t.payload]:!0}}:e},{mountedPlacements:{},registerdAfterActionPlacements:{}}),{mountedPlacements:o,registerdAfterActionPlacements:s}=t,l=(0,r.I0)(),u=(0,r.v9)(e=>e.experiences),_=(0,y.be)(),a=(0,y.Am)(),c=(0,y.Ig)(),d=(0,i.useMemo)(()=>{let e=(0,w.bindActionCreators)({completeExperience:_,dismissExperience:a,fetchAllExperiences:y.fO,fetchAllExperiencesMulti:y.NW,fetchExperienceForPlacements:y.pz,mountPlacement:y.N,triggerExperimentsForPlacement:y.kd,viewExperience:c},l);return{...e,mountPlacement:(t,...i)=>{e.mountPlacement(t,...i),n({type:"MOUNT_PLACEMENT",payload:t})},unmountPlacement:e=>{n({type:"UNMOUNT_PLACEMENT",payload:e})},registerAfterActionPlacement:e=>{n({type:"REGISTER_AFTER_ACTION_PLACEMENT",payload:e})}}},[_,a,l,n,c]),E=(0,i.useMemo)(()=>({experiences:u,mountedPlacements:o,registerdAfterActionPlacements:s,...d}),[u,o,s,d]);return(0,P.jsx)(x.L,{value:E,children:e})}var S=n("616550"),b=n("922184"),C=n("246834");function R({children:e}){let t=(0,S.TH)(),n=(0,C.Z)(),[r,o]=(0,i.useState)(!0),s=(0,i.useCallback)(()=>{if(n&&r){let e=new URLSearchParams(t.search);if(!e.get("url")){o(!1);let t={},n=e.get("tracking_id")||e.get("e_t"),i=e.get("utm_campaign"),r=e.get("utm_source");if(n&&i&&r)return t.message_type=i,t.tracking_id=n,t.utm_source=r,JSON.stringify(t)}}},[r,n,t.search]),l=(0,i.useMemo)(()=>({getLandingContext:s}),[s]);return(0,P.jsx)(b.T,{value:l,children:e})}var N=n("561162"),I=n("3879"),L=n("424428"),O=n("445029"),j=n("760279"),k=n("462478"),F=n("256531"),D=n("3366"),Z=n("236256");function U({children:e}){let t=(0,o.v)(),n=(0,F.Z)(),i=(0,h.w)({contextLogger:t,isVisiblityExperimentEnabled:n});return(0,Z.Z)(()=>{document.hasFocus()&&i.registerApp(),i.addEventListeners()}),(0,P.jsx)(D.$,{value:i,children:e})}var M=n("959474"),B=n("719711"),W=n("161560"),H=n("798556"),V=n("757892"),G=n("716996");function $({children:e}){let t=(0,G.kW)(),n=Object.keys(t).find(e=>void 0!==t[e].login_state),r=n?t[n]:void 0,o=(0,i.useMemo)(()=>(0,B.Z)(r),[r]),s=(0,I.gf)(),{isAuth:l}=o,{isAuthenticated:u}=(0,I.B)();return(0,i.useEffect)(()=>{u!==l&&s({isAuthenticated:l})},[u,l]),(0,P.jsx)(M.$,{value:o,children:e})}function z({children:e}){let t=(0,N.F)(),n=(0,F.Z)(),r=(0,V.AF)(),l=(0,i.useRef)(e=>r[e]);(0,i.useEffect)(()=>{l.current=e=>r[e]},[r]);let u=(0,i.useMemo)(()=>(function({getReduxPin:e,shortFlushTimoutExperimentEnabled:t=!1,isVisiblityExperimentEnabled:n=!1}){let i=new T({shortFlushTimoutExperimentEnabled:t,isVisiblityExperimentEnabled:n});window.addEventListener&&window.addEventListener("focus",()=>{if(i._clickthroughStartEvent){let e=i._clickthroughStartEvent;i._clickthroughStartEvent=null;let t={...e,event_type:4100,duration_ns:(0,a.Z)()-e.time};i.addEvent(t)}});let r=t=>{try{let n=t?e(t):void 0;return n?`${n.tracking_params??""}~0`:void 0}catch{return}},o={flushContextEvents:e=>i.flushEvents(e),logContextEvent:e=>{if(null===e.event_type||void 0===e.event_type)return;let t=e.clientTrackingParams||r(e.object_id_str);i.addEvent({...e,clientTrackingParams:t},o.injectSetViewContextDataFromHook)},logImpression:({auxData:e,component:t,eventData:n,eventType:r,impressionType:s,objectIdStr:l,viewData:u,viewParameter:_,viewType:a})=>{null!=r&&i.addEvent({event_type:r,event_data:{[s]:n},component:t,object_id_str:l,aux_data:e,view_type:a,view_parameter:_,view_data:u},o.injectSetViewContextDataFromHook)}};return f=(0,h.w)({contextLogger:o,isVisiblityExperimentEnabled:n}),s.Z.contextLogger=o,o})({getReduxPin:e=>l.current(e),shortFlushTimoutExperimentEnabled:t.checkExperiment("web_context_logs_long_flush_timeout").anyEnabled,isVisiblityExperimentEnabled:n}),[t,n]);return(0,P.jsx)(o.B,{value:u,children:e})}function J(e){let{children:t,reduxStore:n,serverState:o,...l}=e,u=(0,i.useRef)(!1),_=(0,i.useMemo)(()=>new k.ZP,[]);return u.current||(function(e,t){if(!window)return;let n={},i=(e,i)=>{let r=decodeURIComponent(i),o=new Promise(t=>{n[e]||(n[e]={}),n[e][r]=t});t.add(e,r,o)},r=t=>{let{normalizedResponse:i,options:r,resource:o,response:l,schema:u}=(0,j.Z)(t);l.resource_response.error?408!==l.resource_response.error.http_status&&e.dispatch((0,O.Tl)(o,r,l.resource_response.error)):(s.Z.fetchCompleteCallback&&s.Z.fetchCompleteCallback({resource:o,options:r,response:l,normalizedResponse:i,refresh:!1,resourceSchema:u}),e.dispatch((0,O.Sr)(o,r,l,i,!1,u))),n[o]?.[L.Z(r)]?.()};window.__PWS_RESOURCE_PENDING_FETCH_HANDLER__=i,window.__PWS_RESOURCE_SSR_HANDLER__=r;let o=Object.keys(window.__PWS_RESOURCE_PENDING_BEFORE_INIT__);o.length&&(o.forEach(e=>{window.__PWS_RESOURCE_PENDING_BEFORE_INIT__[e].forEach(t=>{i(e,t)})}),window.__PWS_RESOURCE_PENDING_BEFORE_INIT__={}),window.__PWS_RESOURCE_DATA_BEFORE_INIT__.length&&(window.__PWS_RESOURCE_DATA_BEFORE_INIT__.forEach(r),window.__PWS_RESOURCE_DATA_BEFORE_INIT__=[])}(n,_),u.current=!0),(0,P.jsx)(W.Z,{...l,children:(0,P.jsx)(k.F_,{value:_,children:(0,P.jsx)(r.zt,{store:n,children:(0,P.jsx)(H.fJ,{children:(0,P.jsx)(V._S,{children:(0,P.jsx)(G.kY,{children:(0,P.jsx)($,{children:(0,P.jsx)(z,{children:(0,P.jsx)(A,{children:(0,P.jsx)(R,{children:(0,P.jsx)(U,{children:t})})})})})})})})})})})}},922184:function(e,t,n){n.d(t,{T:function(){return i},Z:function(){return o}});let{Provider:i,useHook:r}=(0,n(486188).Z)("NotificationContext"),o=r}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/38325-c8d624fe6864f8f6.mjs.map